<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>zheng 框架解析 (一) | Black House</title>
    <meta name="description" content="代码千万行, 注释第一行, 编码不规范, 同事两行泪.">
    <link rel="icon" href="/favicon.ico">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.35477964.css" as="style"><link rel="preload" href="/assets/js/app.23d4d300.js" as="script"><link rel="preload" href="/assets/js/4.28fd9624.js" as="script"><link rel="preload" href="/assets/js/1.928d15b1.js" as="script"><link rel="preload" href="/assets/js/17.02d12878.js" as="script"><link rel="prefetch" href="/assets/js/10.c2349238.js"><link rel="prefetch" href="/assets/js/100.031b764c.js"><link rel="prefetch" href="/assets/js/11.597103f4.js"><link rel="prefetch" href="/assets/js/12.01e326a5.js"><link rel="prefetch" href="/assets/js/13.6937eabc.js"><link rel="prefetch" href="/assets/js/14.0e95ab13.js"><link rel="prefetch" href="/assets/js/15.43c0e778.js"><link rel="prefetch" href="/assets/js/16.8c75ae64.js"><link rel="prefetch" href="/assets/js/18.6b597676.js"><link rel="prefetch" href="/assets/js/19.524d893b.js"><link rel="prefetch" href="/assets/js/20.11686f52.js"><link rel="prefetch" href="/assets/js/21.ad025f0d.js"><link rel="prefetch" href="/assets/js/22.dca96777.js"><link rel="prefetch" href="/assets/js/23.121a28ab.js"><link rel="prefetch" href="/assets/js/24.99537c05.js"><link rel="prefetch" href="/assets/js/25.8f31fa14.js"><link rel="prefetch" href="/assets/js/26.a121c6cc.js"><link rel="prefetch" href="/assets/js/27.a57ec579.js"><link rel="prefetch" href="/assets/js/28.3f009b45.js"><link rel="prefetch" href="/assets/js/29.9c269e5b.js"><link rel="prefetch" href="/assets/js/30.168f09f3.js"><link rel="prefetch" href="/assets/js/31.ed454542.js"><link rel="prefetch" href="/assets/js/32.5f77ac76.js"><link rel="prefetch" href="/assets/js/33.3b921274.js"><link rel="prefetch" href="/assets/js/34.2e2dd8bc.js"><link rel="prefetch" href="/assets/js/35.457382a4.js"><link rel="prefetch" href="/assets/js/36.097474f8.js"><link rel="prefetch" href="/assets/js/37.2914dab3.js"><link rel="prefetch" href="/assets/js/38.bd900eff.js"><link rel="prefetch" href="/assets/js/39.00b0bb76.js"><link rel="prefetch" href="/assets/js/40.6d5aae82.js"><link rel="prefetch" href="/assets/js/41.e00929aa.js"><link rel="prefetch" href="/assets/js/42.b0c12805.js"><link rel="prefetch" href="/assets/js/43.7a60ce77.js"><link rel="prefetch" href="/assets/js/44.adf74ab9.js"><link rel="prefetch" href="/assets/js/45.36b6b8e2.js"><link rel="prefetch" href="/assets/js/46.a254f56a.js"><link rel="prefetch" href="/assets/js/47.aec9ad68.js"><link rel="prefetch" href="/assets/js/48.e3477ba7.js"><link rel="prefetch" href="/assets/js/49.5d974cde.js"><link rel="prefetch" href="/assets/js/5.c7e63593.js"><link rel="prefetch" href="/assets/js/50.c71471a2.js"><link rel="prefetch" href="/assets/js/51.de15920e.js"><link rel="prefetch" href="/assets/js/52.1eabf9c1.js"><link rel="prefetch" href="/assets/js/53.ada4082c.js"><link rel="prefetch" href="/assets/js/54.985c146e.js"><link rel="prefetch" href="/assets/js/55.33da5078.js"><link rel="prefetch" href="/assets/js/56.8b899006.js"><link rel="prefetch" href="/assets/js/57.f7ea6441.js"><link rel="prefetch" href="/assets/js/58.55ca22b7.js"><link rel="prefetch" href="/assets/js/59.3b16a882.js"><link rel="prefetch" href="/assets/js/6.8843ac12.js"><link rel="prefetch" href="/assets/js/60.7365ec6c.js"><link rel="prefetch" href="/assets/js/61.0508510a.js"><link rel="prefetch" href="/assets/js/62.8c3a0bf0.js"><link rel="prefetch" href="/assets/js/63.99503945.js"><link rel="prefetch" href="/assets/js/64.1193b17d.js"><link rel="prefetch" href="/assets/js/65.40a7b476.js"><link rel="prefetch" href="/assets/js/66.c95c74fb.js"><link rel="prefetch" href="/assets/js/67.dcc1ce00.js"><link rel="prefetch" href="/assets/js/68.e8aeba6d.js"><link rel="prefetch" href="/assets/js/69.13b69234.js"><link rel="prefetch" href="/assets/js/7.cda98f34.js"><link rel="prefetch" href="/assets/js/70.2308210c.js"><link rel="prefetch" href="/assets/js/71.bdac7c88.js"><link rel="prefetch" href="/assets/js/72.d5e7dabc.js"><link rel="prefetch" href="/assets/js/73.f1cec72d.js"><link rel="prefetch" href="/assets/js/74.13cbda62.js"><link rel="prefetch" href="/assets/js/75.5ec77696.js"><link rel="prefetch" href="/assets/js/76.e80c98fb.js"><link rel="prefetch" href="/assets/js/77.edf10bf3.js"><link rel="prefetch" href="/assets/js/78.9472aec2.js"><link rel="prefetch" href="/assets/js/79.2f59f6d2.js"><link rel="prefetch" href="/assets/js/8.64e66a3d.js"><link rel="prefetch" href="/assets/js/80.9d9b311d.js"><link rel="prefetch" href="/assets/js/81.112c831f.js"><link rel="prefetch" href="/assets/js/82.e98222ae.js"><link rel="prefetch" href="/assets/js/83.a7741563.js"><link rel="prefetch" href="/assets/js/84.47f9ec86.js"><link rel="prefetch" href="/assets/js/85.4b288089.js"><link rel="prefetch" href="/assets/js/86.d01d1b2a.js"><link rel="prefetch" href="/assets/js/87.26f71539.js"><link rel="prefetch" href="/assets/js/88.0cdca4ad.js"><link rel="prefetch" href="/assets/js/89.fca9f86b.js"><link rel="prefetch" href="/assets/js/9.8fcc4a9b.js"><link rel="prefetch" href="/assets/js/90.49e1e9ad.js"><link rel="prefetch" href="/assets/js/91.58ec2d07.js"><link rel="prefetch" href="/assets/js/92.0da2a72c.js"><link rel="prefetch" href="/assets/js/93.9d312aaf.js"><link rel="prefetch" href="/assets/js/94.e94db684.js"><link rel="prefetch" href="/assets/js/95.ed2aa34a.js"><link rel="prefetch" href="/assets/js/96.6a2e264d.js"><link rel="prefetch" href="/assets/js/97.8a055f18.js"><link rel="prefetch" href="/assets/js/98.1284385e.js"><link rel="prefetch" href="/assets/js/99.830ddc7a.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.3ceaf8af.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35477964.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container"><div><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/head.png" alt="Black House" class="logo"> <span class="site-name">Black House</span></a> <div class="links"><div class="color-picker"><a href="#" class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><!----> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">Enable Dark Theme?</label> <input id="dark-theme-toggle" type="checkbox" checked="checked"></div></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/Design.html" class="nav-link"><i class="iconfont undefined"></i>
  Design
</a></li><li class="dropdown-item"><!----> <a href="/category/Framework.html" class="nav-link"><i class="iconfont undefined"></i>
  Framework
</a></li><li class="dropdown-item"><!----> <a href="/category/Spring.html" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/category/Issue.html" class="nav-link"><i class="iconfont undefined"></i>
  Issue
</a></li><li class="dropdown-item"><!----> <a href="/category/Java.html" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/category/Mac.html" class="nav-link"><i class="iconfont undefined"></i>
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/category/Other.html" class="nav-link"><i class="iconfont undefined"></i>
  Other
</a></li><li class="dropdown-item"><!----> <a href="/category/Middleware.html" class="nav-link"><i class="iconfont undefined"></i>
  Middleware
</a></li><li class="dropdown-item"><!----> <a href="/category/NoSQL.html" class="nav-link"><i class="iconfont undefined"></i>
  NoSQL
</a></li><li class="dropdown-item"><!----> <a href="/category/Python.html" class="nav-link"><i class="iconfont undefined"></i>
  Python
</a></li><li class="dropdown-item"><!----> <a href="/category/Tools.html" class="nav-link"><i class="iconfont undefined"></i>
  Tools
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dong4j" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/category/Design.html" class="nav-link"><i class="iconfont undefined"></i>
  Design
</a></li><li class="dropdown-item"><!----> <a href="/category/Framework.html" class="nav-link"><i class="iconfont undefined"></i>
  Framework
</a></li><li class="dropdown-item"><!----> <a href="/category/Spring.html" class="nav-link"><i class="iconfont undefined"></i>
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/category/Issue.html" class="nav-link"><i class="iconfont undefined"></i>
  Issue
</a></li><li class="dropdown-item"><!----> <a href="/category/Java.html" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/category/Mac.html" class="nav-link"><i class="iconfont undefined"></i>
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/category/Other.html" class="nav-link"><i class="iconfont undefined"></i>
  Other
</a></li><li class="dropdown-item"><!----> <a href="/category/Middleware.html" class="nav-link"><i class="iconfont undefined"></i>
  Middleware
</a></li><li class="dropdown-item"><!----> <a href="/category/NoSQL.html" class="nav-link"><i class="iconfont undefined"></i>
  NoSQL
</a></li><li class="dropdown-item"><!----> <a href="/category/Python.html" class="nav-link"><i class="iconfont undefined"></i>
  Python
</a></li><li class="dropdown-item"><!----> <a href="/category/Tools.html" class="nav-link"><i class="iconfont undefined"></i>
  Tools
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeLine/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/dong4j" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>zheng 框架解析 (一)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/views/framework/2017/09062042.html#前提条件" class="sidebar-link">前提条件</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/views/framework/2017/09062042.html#我的环境" class="sidebar-link">我的环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/framework/2017/09062042.html#用到的工具" class="sidebar-link">用到的工具</a></li></ul></li><li><a href="/views/framework/2017/09062042.html#环境搭建" class="sidebar-link">环境搭建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/framework/2017/09062042.html#导入-sql" class="sidebar-link">导入 SQL</a></li><li class="sidebar-sub-header"><a href="/views/framework/2017/09062042.html#修改配置文件" class="sidebar-link">修改配置文件</a></li><li class="sidebar-sub-header"><a href="/views/framework/2017/09062042.html#启动依赖" class="sidebar-link">启动依赖</a></li><li class="sidebar-sub-header"><a href="/views/framework/2017/09062042.html#启动服务" class="sidebar-link">启动服务</a></li></ul></li><li><a href="/views/framework/2017/09062042.html#项目部属" class="sidebar-link">项目部属</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page reco-hide"> <div class="page-title"><h1>zheng 框架解析 (一)</h1> <hr> <div data-v-0b496ca7><i class="iconfont reco-account" data-v-0b496ca7><span data-v-0b496ca7>dong4j</span></i> <i class="iconfont reco-date" data-v-0b496ca7><span data-v-0b496ca7>7/6/2017</span></i> <!----> <i class="iconfont reco-tag tags" data-v-0b496ca7><span class="tag-item" data-v-0b496ca7>
      Zheng
    </span></i></div></div> <div class="content__default"><div class="tip custom-block"><p>其实前面写了一些东西, 但还是删了, 直接撸代码.
这篇是从 git clone 项目开始, 从搭建环境到部属的过程, 希望对想学习的朋友有帮助.</p> <p>这是第一篇, 会有系列解析文档放出.</p></div> <h2 id="前提条件"><a href="#前提条件" aria-hidden="true" class="header-anchor">#</a> 前提条件</h2> <p>群里面有一篇 <code>zheng-环境搭建及系统部署文档20170213(三版).docx</code>, 里面详细讲解了各个依赖软件的安装和配置,
所以这里不会再讲依赖的搭建过程.
假设你已经将所有的依赖环境搭建完毕.</p> <h2 id="我的环境"><a href="#我的环境" aria-hidden="true" class="header-anchor">#</a> 我的环境</h2> <table><thead><tr><th>名称</th> <th>版本</th></tr></thead> <tbody><tr><td>系统</td> <td>MacOS 10.12.6</td></tr> <tr><td>IDE</td> <td>Intellij IDEA 2017.2.3</td></tr> <tr><td>JDK</td> <td>1.8</td></tr> <tr><td>Maven</td> <td>3.3.9</td></tr> <tr><td>Dubbo</td> <td>2.5.3</td></tr> <tr><td>Zookeepe</td> <td>3.4.10</td></tr> <tr><td>Nginx</td> <td>1.12.1</td></tr> <tr><td>ActiveMQ</td> <td>5.15.0</td></tr> <tr><td>MySQL</td> <td>5.7.16</td></tr> <tr><td>Redis</td> <td>3.2.3</td></tr> <tr><td>Dubbo-admin</td> <td></td></tr> <tr><td>Dubbo-monitor</td> <td></td></tr></tbody></table> <h3 id="用到的工具"><a href="#用到的工具" aria-hidden="true" class="header-anchor">#</a> 用到的工具</h3> <ol><li>IDEA</li> <li>LICEcap --&gt; gif 制作</li> <li>MWeb --&gt; Markdown 编辑器</li> <li>iTerm --&gt; 替代 Terminal 的工具</li></ol> <h2 id="环境搭建"><a href="#环境搭建" aria-hidden="true" class="header-anchor">#</a> 环境搭建</h2> <p>我记得去年还是前年, 用 Intellij IDEA 的人已经超过了 Eclipse, 如果你还在用 Eclipse, 我想安利你马上转到 IDEA 来, 不是一般的好用, 我已经安利了不下 50 人 使用 IDEA 了.</p> <p>之后的系列文章, 会穿插一些 IDEA 的教程, 在实践中学习, 效果杠杠的.</p> <p>这里强烈推荐一个专门写 IDEA 的教程, 希望能帮助你一些</p> <p>https://github.com/judasn/IntelliJ-IDEA-Tutorial.git</p> <p>不要怕不会用, 等你学会了以后, 效率是别人的几倍</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-15047038259917.jpg" alt=""></p> <p>clone 项目, 使用 Intellji IDEA 导入这些就不说了</p> <p>这步完成的样子是这样的</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-09-06%209.09.13.png" alt="屏幕快照 2017-09-06 9.09.13"></p> <p>项目结构和命名看着非常舒服</p> <h3 id="导入-sql"><a href="#导入-sql" aria-hidden="true" class="header-anchor">#</a> 导入 SQL</h3> <p>找到 <code>project-datamodel --&gt; zheng.sql</code> , 双击打开</p> <p>如果是第一次打开这个项目, 你肯定会看到这个</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-15047039208288.png" alt=""></p> <h4 id="设置数据库"><a href="#设置数据库" aria-hidden="true" class="header-anchor">#</a> 设置数据库</h4> <p>设置之前你得使用命令或者 navicat 创建一个叫 <code>zheng</code> 的数据库</p> <h5 id="问题1-1067-invalid-default-value-for-last-login-time"><a href="#问题1-1067-invalid-default-value-for-last-login-time" aria-hidden="true" class="header-anchor">#</a> 问题1: [1067] Invalid default value for 'last_login_time'</h5> <p>导入 SQL 报错</p> <p>首先复习下 MySQl 中 datetime, timestamp, date 的区别.</p> <table><thead><tr><th>日期类型</th> <th>存储空间</th> <th>日志格式</th> <th>日期范围</th></tr></thead> <tbody><tr><td>datetime</td> <td>8 bytes</td> <td>YYYY-MM-DD HH:MM:SS</td> <td>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td></tr> <tr><td>timestamp</td> <td>4 bytes</td> <td>YYYY-MM-DD HH:MM:SS</td> <td>1970-01-01 00:00:01 ~ 2037-12-31 23:59:59</td></tr> <tr><td>date</td> <td>3 bytes</td> <td>YYYY-MM-DD</td> <td>1000-01-01 ~ 9999-12-31</td></tr></tbody></table> <p>这里用 <code>timestamp</code></p> <ol><li>占用空间小</li> <li>在进行 <code>insert</code>, <code>update</code> 数据时，<code>timestamp</code> 列会自动以当前时间（CURRENT_TIMESTAMP）填充/更新.</li></ol> <p>但是到 2038-00-00 00:00:00 时, 系统就崩溃了, 想想就刺激, 😂</p> <p><strong>然而并不是这个问题</strong></p> <p>这种报错多半是你 MySQl 升级到 5.7 而引起的默认值不兼容的问题.
想到可能是类型的默认值被限制了，查看 sql_mode.</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'sql_mode'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>sql_mode	STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</p></blockquote> <p>果然 NO_ZERO_IN_DATE, NO_ZERO_DATE 这两个参数限制时间不能为0</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 临时解决</span>
<span class="token keyword">set</span> <span class="token keyword">session</span> sql_mode<span class="token operator">=</span><span class="token string">'STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 永久方案
# 直接修改my.cnf文件

在[mysqld]下面添加如下列：

sql_mode=STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="http://qiniu.dong4j.info/2019-07-03-15047081644118.png" alt=""></p> <p>风骚的操作, 完美的表名 😁</p> <h3 id="修改配置文件"><a href="#修改配置文件" aria-hidden="true" class="header-anchor">#</a> 修改配置文件</h3> <p>密码值使用了 AES 加密，使用 <code>com.zheng.common.util.AESUtil</code> 工具类修改这些值</p> <p>这么多文件怎么找?</p> <p>IDEA 的强大之处<strong>之一</strong>就在于它强大的搜索功能. 第一次打开项目时, IDEA 会花点时间创建所有除了 <code>Exclued Folders</code> 的文件的索引.</p> <p>不管这些, 直接使用 <code>双击 shift</code> 来全局查找.</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-2.gif" alt="2"></p> <p>胡悠我, 打开的全是占位符的配置文件, 还要去找主配置才行, 然后一个一个的改? you are so young so simple</p> <p>全局替换, 秒秒钟的事</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-3.gif" alt="3"></p> <p>其他的照着来</p> <h3 id="启动依赖"><a href="#启动依赖" aria-hidden="true" class="header-anchor">#</a> 启动依赖</h3> <p>我启动这些依赖贼简单, 不信你看</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-09-06%2011.36.55.png" alt="屏幕快照 2017-09-06 11.36.55"></p> <p>start, start, start ....</p> <p>我记得以前用 windows 的时候, 启动这些依赖很恼火, 一个一个启动, 后来写了个批处理, 一建启动, 在虚拟机上, 懒的开了.....</p> <h4 id="配置-nginx"><a href="#配置-nginx" aria-hidden="true" class="header-anchor">#</a> 配置 nginx</h4> <p>这里先说一个 windows 的坑</p> <p>nginx.conf 配置文件默认编码是 utf-8, 在 windows 上使用记事本打开 utf-8 编码的文件, 它会在文件前面加上一个 <code>BOM</code> 😂, 不知道你们有没有踩过这个坑....</p> <p>也是这个坑, 又踩了一次.</p> <p>是项目上一个 Excel 导出的问题</p> <p>poi 导出大量数据, 内存溢出, 所以到数据量很大时, 就用导出文本文件的方式</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 数据存放的位置</span>
    <span class="token class-name">String</span> path<span class="token operator">=</span><span class="token string">&quot;/Users/xxx/Develop/test.xls&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// 生成文件</span>
    <span class="token class-name">BufferedWriter</span> buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//插入标题 代表3列</span>
    buff<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;部门名称\t用户\t电话&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 换行</span>
    buff<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//插入5万条记录</span>
    <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;中文测试&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">50000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        buff<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>s <span class="token operator">+</span>  <span class="token string">&quot;\tzheng\t1234567890&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        buff<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    buff<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>如果 windows 的用户使用 Excel 打开就会是乱码, 原因就是上面说到的</p> <p>改为:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>@Test
public void test() throws IOException {
    // 数据存放的位置
    String path=&quot;/Users/codeai/Develop/test.xls&quot;;
    // 生成文件
    BufferedWriter buff = new BufferedWriter(new FileWriter(path));
    // 在文件开始加一个  U+FEFF
    buff.write(new String(new byte[] {(byte) 0xEF, (byte) 0xBB, (byte) 0xBF}));
    //插入标题 代表3列
    buff.write(&quot;部门名称,用户,电话&quot;);
    // 换行
    buff.write(&quot;\r\n&quot;);
    //插入5万条记录
    String s = &quot;中文测试&quot;;
    for (int i = 0; i &lt; 50000; i++) {
        buff.write(s +  &quot;,zheng,1234567890&quot;);
        buff.write(&quot;\r\n&quot;);
    }
    buff.close();
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>为巨硬感到委屈, 明明是它先，什么都是它先的，VC6 也好，BOM 也罢... 为什么不按照它的来了, 搞得它现在想改都不行了.... 😂</p> <p><strong>所以在 windows 下, 不要用 记事本, 用 sublime text 或者 vscode.</strong></p> <p>扯远了............. 😅</p> <p>2个 server 配置, 没有看到 zheng-config 模块, 所有这里只配置一个反向代理</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment">#user  nobody;</span>
<span class="token keyword">worker_processes</span>  <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">events</span> <span class="token punctuation">{</span>
    <span class="token keyword">worker_connections</span>  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">http</span> <span class="token punctuation">{</span>
    <span class="token keyword">include</span>       mime<span class="token punctuation">.</span><span class="token keyword">types</span><span class="token punctuation">;</span>
    <span class="token keyword">default_type</span>  application<span class="token operator">/</span>octet<span class="token operator">-</span>stream<span class="token punctuation">;</span>
    <span class="token keyword">sendfile</span>        on<span class="token punctuation">;</span>
    <span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span><span class="token punctuation">;</span>

    <span class="token keyword">server</span> <span class="token punctuation">{</span>
        <span class="token keyword">listen</span>  <span class="token number">9526</span><span class="token punctuation">;</span>
        <span class="token keyword">server_name</span>  localhost<span class="token punctuation">;</span>
        <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
            <span class="token keyword">root</span>   <span class="token operator">/</span>Users<span class="token operator">/</span>codeai<span class="token operator">/</span>Develop<span class="token operator">/</span>codes<span class="token operator">/</span>Java<span class="token operator">/</span>zheng<span class="token operator">/</span>zheng<span class="token operator">-</span>ui<span class="token operator">/</span>zheng<span class="token operator">-</span>cms<span class="token operator">-</span>web<span class="token operator">/</span><span class="token punctuation">;</span>
            <span class="token keyword">index</span>  <span class="token keyword">index</span><span class="token punctuation">.</span>html <span class="token keyword">index</span><span class="token punctuation">.</span>htm<span class="token punctuation">;</span>
            <span class="token keyword">add_header</span> Access<span class="token operator">-</span>Control<span class="token operator">-</span><span class="token keyword">Allow</span><span class="token operator">-</span>Origin <span class="token operator">*</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="启动服务"><a href="#启动服务" aria-hidden="true" class="header-anchor">#</a> 启动服务</h3> <p>启动之前 先 <code>install</code> 一下</p> <ol><li>zheng-upms-rpc-service</li> <li>zheng-cms-rpc-service</li> <li>zheng-upms-server</li> <li>zheng-cms-admin</li></ol> <p><img src="http://qiniu.dong4j.info/2019-07-03-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-09-07%2012.54.21.png" alt="屏幕快照 2017-09-07 12.54.21"> <img src="http://qiniu.dong4j.info/2019-07-03-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-09-07%2012.57.25.png" alt="屏幕快照 2017-09-07 12.57.25"></p> <p><img src="http://qiniu.dong4j.info/2019-07-03-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-09-07%2012.57.33.png" alt="屏幕快照 2017-09-07 12.57.33"></p> <h2 id="项目部属"><a href="#项目部属" aria-hidden="true" class="header-anchor">#</a> 项目部属</h2> <p>😂</p> <p>太晚了, 后天要早去去大理拍婚纱照, 留着后面写
只是照着项目的 readme.md 把环境搭好了,能成功运行了, 里面的代码还没看</p> <p>像这些环境依赖, 大家可以使用 Vagrant 来搭建, 以后换电脑或者给别的同事搭建环境, 丢一个文件给他就 ok 了.
或者使用 docker, 说得我好像会一样.... 😂, 还没开始看呢 哈哈, 以后大家一起学习</p> <p><strong>感谢 zheng 哥给我们开源这么好的学习框架</strong></p> <p>如果我没叫错的话, 应该叫 zheng 哥吧...</p> <p><img src="http://qiniu.dong4j.info/2019-07-03-15047175726527.png" alt=""></p> <p><img src="http://qiniu.dong4j.info/2019-07-03-15047176152833.png" alt=""></p> <p>为什么 0 不代表女? 这样好记啊</p> <p>向 Facebook 学习, 增加 56 种性别, 那才好玩  😂😂😂</p></div> <!----> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/3/2019, 6:30:00 PM</span></div></footer> <!----> </main> <div class="valine-wrapper" data-v-0162251c><div id="valine" data-v-0162251c></div></div></div> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-d0bfeaa4 data-v-d0bfeaa4><i class="iconfont reco-up" data-v-d0bfeaa4></i></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.23d4d300.js" defer></script><script src="/assets/js/4.28fd9624.js" defer></script><script src="/assets/js/1.928d15b1.js" defer></script><script src="/assets/js/17.02d12878.js" defer></script>
  </body>
</html>
